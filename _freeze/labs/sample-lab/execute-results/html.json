{
  "hash": "55f07debc4c55baef80d7070ba1fdb04",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Sample Census Analysis\"\nsubtitle: \"Demonstrating tidycensus and spatial analysis\"\ndate: today\nauthor: \"Zhanchao\"\nformat:\n  html:\n    code-fold: true\n    toc: true\n---\n\n\n\n## 1. Load Census Data\n\n\n::: {.cell progress='false'}\n\n```{.r .cell-code}\n# Get Philadelphia County data\nphilly_income <- get_acs(\n  geography = \"tract\",\n  variables = \"B19013_001\", # Median household income\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE,\n  year = 2022,\n  progress = FALSE\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGetting data from the 2018-2022 5-year ACS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Clean the data\nphilly_income <- philly_income |>\n  filter(!is.na(estimate)) |>\n  mutate(income_k = estimate / 1000) \n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(philly_income, aes(x = income_k)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(\n    title = \"Distribution of Median Household Income\",\n    subtitle = \"Philadelphia Census Tracts, 2022 ACS\",\n    x = \"Median Household Income (thousands)\",\n    y = \"Number of Census Tracts\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution of median household income in Philadelphia](sample-lab_files/figure-html/explore-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphilly_income <- philly_income |>\n  mutate(\n    income_class = case_when(\n      income_k < 25 ~ \"Under $25k\",\n      income_k >= 25 & income_k < 50 ~ \"$25k - $50k\", \n      income_k >= 50 & income_k < 75 ~ \"$50k - $75k\",\n      income_k >= 75 & income_k < 100 ~ \"$75k - $100k\",\n      income_k >= 100 ~ \"$100k+\"\n    ),\n    # Convert to factor to control order\n    income_class = factor(income_class, \n                         levels = c(\"Under $25k\", \"$25k - $50k\", \"$50k - $75k\", \n                                   \"$75k - $100k\", \"$100k+\"))\n  )\n\n# Create choropleth map with classes\nggplot <- ggplot(philly_income) +\n  geom_sf(aes(fill = income_class), color = \"white\", size = 0.1) +\n  scale_fill_brewer(type = \"seq\", palette = \"YlOrRd\", name = \"Median\\nIncome\") +\n  labs(\n    title = \"Median Household Income by Census Tract\",\n    subtitle = \"Philadelphia, 2022 ACS 5-Year Estimates\",\n    caption = \"Source: U.S. Census Bureau\"\n  ) +\n  theme_void() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 12, hjust = 0.5),\n    legend.position = \"bottom\"\n  )\n\n# Get water features for Philadelphia\nphilly_water <- area_water(state = \"PA\", county = \"Philadelphia\", \n                          year = 2022, progress = FALSE)\n# Add to your map\nggplot() +\n  # Water first (background)\n  geom_sf(data = philly_water, fill = \"lightblue\", color = \"lightblue\", alpha = 0.7) +\n  # Then census tracts on top\n  geom_sf(data = philly_income, aes(fill = income_class), color = \"white\", size = 0.1) +\n  scale_fill_brewer(type = \"seq\", palette = \"YlOrRd\", name = \"Median\\nIncome\") +\n  labs(\n    title = \"Median Household Income by Census Tract\",\n    subtitle = \"Philadelphia, 2022 ACS 5-Year Estimates\",\n    caption = \"Source: U.S. Census Bureau\"\n  ) +\n  theme_void() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 12, hjust = 0.5),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](sample-lab_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "sample-lab_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}